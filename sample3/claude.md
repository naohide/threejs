# teamLab Style Flower Garden - アプリケーションガイド

## 概要

Three.jsを使用してチームラボ風の没入型フラワーガーデンを再現したインタラクティブアート空間。3Dジオメトリの花びらとカスタムシェーダーによるリアルなアニメーション、散る花びらパーティクルを実装。

## ビジュアルスタイル

- **テーマ**: チームラボ風デジタルアート
- **背景**: 深い紫がかった暗い空間（フォグ効果付き）
- **植物**: 3Dジオメトリ花びら + カスタムシェーダー
- **照明**: カラフルなポイントライト + 強化ブルーム効果
- **構造**: sin関数によるアーチ型天井
- **エフェクト**: 散る花びらパーティクル（500個）

## 動作要件

- WebGL対応のモダンブラウザ
- デスクトップ/モバイル両対応

## 起動方法

1. ブラウザで `index.html` を開く
2. ローディング画面が表示される
3. 読み込み完了後、花園空間が表示される

---

## コントロール

### マウス操作（デスクトップ）

| 操作 | 効果 |
|------|------|
| マウス移動 | 視点を微妙に動かす |
| ドラッグ | 視点を大きく回転 |
| スクロール | 前後に移動 |
| クリック | 周囲の植物を成長させる |

### タッチ操作（モバイル）

| 操作 | 効果 |
|------|------|
| スワイプ | 視点を回転 |
| ピンチ | 前後に移動 |
| タップ | 周囲の植物を成長させる |

---

## 技術仕様

| パラメータ | 値 |
|-----------|-----|
| 地面サイズ | 60 x 60 |
| アーチ高さ | 30 |
| アーチ幅 | 40 |
| 花の数 | 150（3Dジオメトリ） |
| 草の数 | 200（インスタンス描画） |
| 散る花びら | 500 |
| 最大成長倍率 | 2.5 |
| 成長速度 | 0.015 |
| カメラFOV | 70度 |
| カメラ高さ | 1.8 |
| ブルーム強度 | 1.2 |

## アーキテクチャ

```
index.html（単一ファイル）
├── CSS
│   ├── ローディング画面
│   ├── 操作説明オーバーレイ
│   └── FPS表示
├── HTML
│   ├── ローディングUI
│   ├── Three.jsキャンバスコンテナ
│   └── 操作説明パネル
└── JavaScript (ES Module)
    ├── 設定（CONFIG）
    ├── カスタムシェーダー
    │   ├── flowerVertexShader（風・成長・呼吸アニメーション）
    │   ├── flowerFragmentShader（グラデーション・グロー・葉脈）
    │   ├── petalVertexShader（落下・螺旋・揺れ）
    │   ├── petalFragmentShader（ソフトパーティクル）
    │   ├── grassVertexShader（風に揺れる草）
    │   └── grassFragmentShader
    ├── Three.jsセットアップ
    │   ├── シーン・カメラ・レンダラー
    │   ├── EffectComposer + UnrealBloomPass
    │   ├── 照明（Ambient + Hemisphere + 7色PointLight）
    │   ├── 地面（PlaneGeometry + 起伏）
    │   └── アーチ天井（BufferGeometry）
    ├── 3D花生成
    │   ├── ExtrudeGeometry（花びら形状）
    │   ├── InstancedMesh（パフォーマンス最適化）
    │   ├── 複数レイヤーの花びら
    │   └── 茎（CylinderGeometry）
    ├── 3D草生成
    │   ├── PlaneGeometry（曲がった草）
    │   └── InstancedMesh（5本/クランプ）
    ├── 散る花びらパーティクル
    │   ├── Points + BufferGeometry
    │   ├── 螺旋落下アニメーション
    │   └── ループ再生
    ├── ユーザーコントロール
    │   ├── マウスイベント
    │   └── タッチイベント
    └── アニメーション
        ├── カメラ更新
        ├── 花成長（シェーダーuniform）
        ├── 風アニメーション（複数周波数）
        └── 呼吸エフェクト
```

## 主な機能

1. **3Dジオメトリ花びら**: ExtrudeGeometryによるリアルな花びら形状
2. **カスタムシェーダーアニメーション**: sample4の波シェーダーを参考にした風・成長・呼吸エフェクト
3. **散る花びらパーティクル**: 螺旋落下する500個の花びら
4. **InstancedMesh**: パフォーマンス最適化された大量の花と草
5. **マルチレイヤー花びら**: 2層の花びらによる立体感
6. **UnrealBloomPass**: 強化されたグロー効果（teamLab風）
7. **インタラクティブ成長**: クリック/タップで周囲の花が成長
8. **複数周波数の風アニメーション**: 自然な揺れを実現
9. **呼吸エフェクト**: 花全体が微妙に脈動
10. **7色ポイントライト**: 幻想的な空間演出

## 花の色（teamLab風パレット）

### Cherry（桜）
- #ffb7c5, #ff91a4, #ffc0cb, #ffaec9, #f8bbd9

### Lotus（蓮）
- #f8bbd0, #f48fb1, #f06292, #ec407a, #e91e63

### White（白）
- #ffffff, #f5f5f5, #eeeeee, #fafafa, #fff5f5

### Purple（紫）
- #ce93d8, #ba68c8, #ab47bc, #9c27b0, #e1bee7

### Blue（青）
- #90caf9, #64b5f6, #42a5f5, #2196f3, #bbdefb

### Gold（金）
- #ffe082, #ffd54f, #ffca28, #ffc107, #fff8e1

## 草の色

- #3d5a35（ダークグリーン）
- #4a6741（フォレストグリーン）
- #556b4e（モスグリーン）
- #2d4a2a（ディープグリーン）
- #4e6e47（セージグリーン）

## 依存関係

- Three.js r160 (ES Module via unpkg)

---

## インタラクションフロー

```
1. アプリ起動 → ローディング画面表示
2. 植物テクスチャ生成 → プログレスバー更新
3. 読み込み完了 → メイン画面表示
4. マウス/タッチ操作 → 視点変更
5. クリック/タップ → 周囲の植物が成長
6. 時間経過 → 植物が徐々に元のサイズに戻る
7. 継続的 → 植物が揺れ続ける
```

## Qiita記事との対応

| 記事の機能 | 本実装 |
|-----------|--------|
| シーン・カメラ・レンダラー | ✅ PerspectiveCamera (FOV70) |
| 地面層 (PlaneGeometry) | ✅ 60x60の起伏付き平面 |
| アーチ型天井 (sin関数) | ✅ BufferGeometryで実装 |
| 植物のランダム配置 | ✅ 極座標でランダム配置 |
| マウス/タッチ操作 | ✅ 視点制御・前後移動 |
| 植物の成長メカニズム | ✅ クリック/タップで成長（シェーダー制御） |
| ローディング画面 | ✅ プログレスバー付き |
| 3Dジオメトリ花 | ✅ ExtrudeGeometry + InstancedMesh |
| カスタムシェーダー | ✅ 風・成長・呼吸アニメーション |
| 散る花びら | ✅ 500個のパーティクル |
| ブルーム効果 | ✅ UnrealBloomPass (強度1.2) |
